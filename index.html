<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home | myRailTrip</title>
    <!-- css link -->
    <link rel="stylesheet" href="./css/home.css">
    <!-- font awesome link -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css"
        integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <main>
        <section class="sect">
            <div class="headerIntro">
                <div class="intro">myRailTrip</div>
                <div class="notify">Notification</div>
            </div>

            <div class="header">
                <ul>
                    <li><a href="userProfile.html"><img class="story" src="https://loremflickr.com/200/200?random=1"
                                alt=""></a></li>
                    <!-- <li><img class="story" id="story" src="images/971.jpg" alt=""></li> -->
                    <li><img class="story" id="story" src="https://loremflickr.com/200/200?random=22" alt=""></li>
                    <li><img class="story" id="story" src="https://loremflickr.com/200/200?random=3" alt=""></li>
                    <li><img class="story" id="story" src="https://loremflickr.com/200/200?random=13" alt=""></li>
                    <li><img class="story" id="story" src="https://loremflickr.com/200/200?random=31" alt=""></li>
                    <li><img class="story" id="story" src="https://loremflickr.com/200/200?random=97" alt=""></li>
                    <li><img class="story" id="story" src="https://loremflickr.com/200/200?random=67" alt=""></li>
                    <li><img class="story" id="story" src="https://loremflickr.com/200/200?random=51" alt=""></li>
                </ul>
            </div>
            <section class="posts">

                <!-- post view -->
                <div class="engaginPosts">
                    <div class="userProfile">
                        <img src="https://loremflickr.com/200/200?random=16" alt="">
                    </div>
                    <span class="userName">
                        Demo Name
                    </span>
                    <span><small class="location">some Location</small></span>

                    <div class="description-container">
                        <div class="post-description truncated">
                            Here is video description and user needs to click here to see more details about the posts
                        </div>
                        <a href="#" class="read-more">Read more</a>
                    </div>
                    <div class="usersPost">
                        <img src="https://picsum.photos/200/300?random=35" alt="">
                    </div>
                    <div class="icons">
                        <span class="like"><i class="fa-regular fa-heart"></i></span>
                        <span class="comt"><i class="fa-regular fa-comment"></i></span>
                        <span class="share"><i class="fa-regular fa-share-from-square"></i></span>
                    </div>
                    <!-- post 2 -->
                </div>
                <div class="engaginPosts">
                    <div class="userProfile">
                        <img src="https://loremflickr.com/200/200?random=16" alt="">
                    </div>
                    <span class="userName">
                        Demo Name
                    </span>
                    <span><small class="location">some Location</small></span>
                    <div class="usersPost">
                        <img src="https://picsum.photos/200/300?random=12" alt="">
                    </div>
                    <div class="description-container">
                        <div class="post-description truncated">
                            Here is video description and user needs to click here to see more details about the posts
                        </div>
                        <a href="#" class="read-more">Read more</a>
                    </div>
                    <div class="icons">
                        <span class="like" id="like"><i class="fa-regular fa-heart"></i></span>
                        <span class="comt" id="comt"><i class="fa-regular fa-comment"></i></span>
                        <span class="share"><i class="fa-regular fa-share-from-square"></i></span>
                    </div>
                </div>
                <!-- post 3 -->
                <div class="engaginPosts">
                    <div class="userProfile">
                        <img src="https://loremflickr.com/200/200?random=16" alt="">
                    </div>
                    <span class="userName">
                        Demo Name
                    </span>
                    <span><small class="location">some Location</small></span>
                    <div class="usersPost">
                        <img src="https://picsum.photos/200/300?random=1" alt="">
                    </div>
                    <div class="description-container">
                        <div class="post-description truncated">
                            Here is video description and user needs to click here to see more details about the posts
                        </div>
                        <a href="#" class="read-more">Read more</a>
                    </div>
                    <div class="icons">
                        <span class="like"><i class="fa-regular fa-heart"></i></span>
                        <span class="comt"><i class="fa-regular fa-comment"></i></span>
                        <span class="share"><i class="fa-regular fa-share-from-square"></i></span>
                    </div>
                </div>
            </section>
        </section>
        <section>
            <div class="footNavigation">
                <a href="">
                    <i class="fa-solid fa-house">
                    </i>
                </a>
                <a href="videos.html">
                    <i class="fa-solid fa-upload"></i>
                </a>
                <a href="">
                    <label for="uploadVideo"><i class="fa-solid fa-plus"></i></label>
                    <input type="file" name="" id="uploadVideo" accept="video/mp4">
                </a>
                <a href="./userProfile.html">
                    <i class="fa-solid fa-user"></i></a>
            </div>
        </section>
    </main>
</body>
<script src="./fun.js"></script>
<script>

    let viewStory = document.querySelectorAll(".story")
    // console.log(viewStory)
    viewStory.forEach(elm => {
        elm.addEventListener('click', function () {
            //dynamically create element
            let viewStoryDiv = document.createElement('div')
            //styling
            viewStoryDiv.style.position = 'fixed';
            viewStoryDiv.style.top = '0';
            viewStoryDiv.style.left = '0';
            viewStoryDiv.style.width = '100%';
            viewStoryDiv.style.height = '100%';
            viewStoryDiv.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
            viewStoryDiv.style.display = 'flex';
            viewStoryDiv.style.justifyContent = 'center';
            viewStoryDiv.style.alignItems = 'center';
            viewStoryDiv.style.zIndex = '1000';
            //append element
            document.body.appendChild(viewStoryDiv)

            const dynamicView = document.createElement('img')
            const imgSrc = elm.getAttribute('src')
            dynamicView.setAttribute('src', imgSrc)

            //set styles
            dynamicView.style.objectFit = 'contain'
            dynamicView.id = 'viewContent'
            viewStoryDiv.appendChild(dynamicView)

            //auto-close
            const autoCloseTimeOut = setTimeout(function (evt) {
                if (document.body.contains(viewStoryDiv)) {
                    document.body.removeChild(viewStoryDiv)
                }
            }, 30000)

            //click to close
            viewStoryDiv.addEventListener('click', (evt) => {
                //verify change later
                if (evt.target === viewStoryDiv || evt.target === dynamicView) {
                    clearTimeout(viewStoryDiv)
                    document.body.removeChild(viewStoryDiv)
                }
            })
        });

    });

    window.addEventListener('load', function () {
        const footNavigation = document.querySelector('.footNavigation');
        const sect = document.querySelector('.sect');

        // Calculate the height of .footNavigation and set the padding-bottom of section
        const footNavHeight = footNavigation.offsetHeight;
        sect.style.paddingBottom = `${footNavHeight}px`;
    });

    // updated
    // Store videos in an array
    const videosArray = [];

    const uploadVideo = document.getElementById("uploadVideo");

    uploadVideo.addEventListener('change', function (evt) {
        const files = evt.target.files;

        // Loop over the files
        for (let i = 0; i < files.length; i++) {
            const file = files[i];

            // Check if the file is not an MP4
            if (file.type !== 'video/mp4' || !file.name.toLowerCase().endsWith('.mp4')) {
                alert("Please upload a valid MP4 video file with .mp4 extension");
                continue;
            }

            // Max size check (100MB)
            const MAX_SIZE = 100 * 1024 * 1024 * 1024; // 100MB
            if (file.size > MAX_SIZE) {
                alert("File size exceeds 100MB limit");
                continue;
            }

            // Generate a video URL
            const videoUrl = URL.createObjectURL(file);

            // Store in JS object
            const videoData = {
                name: file.name,
                url: videoUrl,
                size: file.size
            };
            videosArray.push(videoData);
        }

        // Reset the input to allow uploading the same file again
        evt.target.value = '';
        localStorage.setItem("videosArray", JSON.stringify(videosArray));
        // video show
        const getVideoUrl = videosArray[0].url
        const getVideoNme = videosArray[0].name
        // create elements
        const viewVideo = document.createElement('div')
        const videoTag = document.createElement('video')
        viewVideo.style.width = "100vw"
        viewVideo.style.height = "100vh"
        viewVideo.id = "videoDiv"
        videoTag.src = getVideoUrl
        videoTag.controls = true
        document.body.appendChild(viewVideo)
        viewVideo.appendChild(videoTag)
    });

    // Retrieve stored videos on page load
    // window.onload = function () {
    //     const storedVideos = JSON.parse(localStorage.getItem("videosArray")) || [];

    //     storedVideos.forEach(video => {
    //         const viewVideo = document.createElement('div');
    //         const videoTag = document.createElement('video');
    //         viewVideo.style.width = "100vw";
    //         viewVideo.style.height = "100vh";
    //         viewVideo.style.zIndex = "0";
    //         // viewVideo.id = "0";
    //         viewVideo.id = "videoDiv";
    //         videoTag.src = video.url;
    //         videoTag.controls = true;
    //         videoTag.id = "myVideo";
    //         document.body.appendChild(viewVideo);
    //         viewVideo.appendChild(videoTag);
    //     });
    // };
    // Helper function to format file size
    // function formatBytes(bytes) {
    //     if (bytes === 0) return '0 Bytes';
    //     const k = 1024;
    //     const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    //     const i = Math.floor(Math.log(bytes) / Math.log(k));
    //     return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    // }
    // description
    
    
</script>
<script src="likecomtFxns.js"></script>
</html>